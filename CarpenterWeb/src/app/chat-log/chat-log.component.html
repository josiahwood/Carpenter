<div style="display: flex; flex-direction: column; height:100%">
  <h1 class="mat-h1" style="margin:5px">Chat Log</h1>
  <div style="flex: 1 1 auto; overflow-y: scroll; padding: 5px" #chatLogDiv>
    <div *ngFor="let chatMessage of chatMessages">
      <ng-container *ngIf="chatMessage.sender === 'User'; else aiChat">
        <mat-card style="margin-left: 20px; margin-top: 2px; margin-bottom: 2px" (click)="onChatMessageClicked(chatMessage)">
          <mat-card-header>
            <mat-card-subtitle>{{chatMessage.sender}}: {{chatMessage.timestamp | date:'medium'}}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content style="white-space-collapse: preserve">{{chatMessage.message}}</mat-card-content>
        </mat-card>
      </ng-container>
      <ng-template #aiChat>
        <mat-card style="margin-right: 20px; margin-top: 2px; margin-bottom: 2px" (click)="onChatMessageClicked(chatMessage)">
          <mat-card-header>
            <mat-card-subtitle>{{chatMessage.sender}}: {{chatMessage.timestamp | date:'medium'}}</mat-card-subtitle>
          </mat-card-header>
          <mat-card-content style="white-space-collapse: preserve">{{chatMessage.message}}</mat-card-content>
        </mat-card>
      </ng-template>
    </div>
  </div>
  <div style="padding: 5px; display:flex; flex-direction: row">
    <textarea [value]="userChatMessage" (input)="onUserChatMessageValueChange($event)" style="height:5em; flex: 1 1 auto; resize: none"></textarea>
    <button mat-raised-button color="primary" type="button" (click)="onSendUserChatMessage()" style="height: unset">
      <ng-container *ngIf="!isWaiting; else isWaitingTemplate">
        <mat-icon>send</mat-icon>
      </ng-container>
      <ng-template #isWaitingTemplate>
        <mat-progress-spinner color="accent" mode="indeterminate" style="width: 24px; height:24px"></mat-progress-spinner>
      </ng-template>
    </button>
  </div>
</div>
